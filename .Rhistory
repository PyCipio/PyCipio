as_tsibble(key = c(confirmed, population, administrative_area_level_2), index = date)
View(y)
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) %>%
select(-date) %>%
as_tsibble(key = c(confirmed, population, administrative_area_level_2), index = date)
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) #%>%
#select(-date) %>%
#as_tsibble(key = c(confirmed, population, administrative_area_level_2), index = date)
View(tsi)
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = c(confirmed, population, administrative_area_level_2), index = date)
View(y)
View(tsi)
View(tsi)
View(data)
View(tsi)
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = c(confirmed, population, administrative_area_level_2), index = date) %>%
select(c(date, confirmed, administrative_area_level_2))
View(tsi)
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = c(confirmed, administrative_area_level_2), index = date) %>%
select(c(date, confirmed, administrative_area_level_2))
View(tsi)
View(tsi)
tsi %>%
ggplot() +
geom_line(aes(x = date, y = confirmed))
tsi %>%
ggplot(aes(x = date, y = confirmed), fill = administrative_area_level_2 ) +
geom_line()
tsi %>%
ggplot(aes(x = date, y = confirmed), color = administrative_area_level_2 ) +
geom_line()
tsi %>%
ggplot(aes(x = date, y = confirmed color = administrative_area_level_2) ) +
tsi %>%
ggplot(aes(x = date, y = confirmed, color = administrative_area_level_2) ) +
geom_line()
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = c(confirmed, administrative_area_level_2), index = date) %>%
select(c(date, confirmed, administrative_area_level_2)) %>%
filter(administrative_area_level_2 == "Oregon" | "Mississippi" | "Nevada")
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = c(confirmed, administrative_area_level_2), index = date) %>%
select(c(date, confirmed, administrative_area_level_2)) %>%
filter(administrative_area_level_2 == "Oregon" |  administrative_area_level_2 == "Mississippi" | administrative_area_level_2 == "Nevada")
tsi %>%
ggplot(aes(x = date, y = confirmed, color = administrative_area_level_2) ) +
geom_line()
pacman::p_load(tidyverse, fpp3, tsibble, feasts, fable)
#load USA sample data covid (statewise)
data <- read.csv(file = "sample_data.csv", header = T)
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = c(confirmed, administrative_area_level_2), index = date) %>%
select(c(date, confirmed, administrative_area_level_2)) %>%
#Subset states
filter(administrative_area_level_2 == "Oregon" |
administrative_area_level_2 == "Mississippi" |
administrative_area_level_2 == "Nevada")
tsi %>%
ggplot(aes(x = date, y = confirmed, color = administrative_area_level_2) ) +
geom_line()
View(tsi)
pacman::p_load(tidyverse, fpp3, tsibble, feasts, fable)
#load USA sample data covid (statewise)
data <- read.csv(file = "sample_data.csv", header = T)
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = c(confirmed, administrative_area_level_2), index = date) %>%
select(c(date, confirmed, administrative_area_level_2)) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" )
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
View(tsi)
#load USA sample data covid (statewise)
data <- read.csv(file = "sample.csv", header = T)
#load USA sample data covid (statewise)
getwd()
#load USA sample data covid (statewise)
getwd()
data <- read.csv(file = "code/sample.csv", header = T)
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = c(confirmed, administrative_area_level_2), index = date) %>%
select(c(date, confirmed, administrative_area_level_2)) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" )
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
View(tsi)
View(data)
View(tsi)
tsi %>%
ggplot(aes(x = date, y = confirmed, color = administrative_area_level_2) ) +
geom_line()
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = c(confirmed, administrative_area_level_2), index = date_idx) %>%
select(c(date, new_infected, administrative_area_level_2)) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" )
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = c(confirmed, administrative_area_level_2), index = date_idx) %>%
select(c(date_idx, new_infected, administrative_area_level_2)) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" )
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
tsi %>%
ggplot(aes(x = date, y = confirmed, color = administrative_area_level_2) ) +
geom_line()
tsi %>%
ggplot(aes(x = date_idx, y = confirmed, color = administrative_area_level_2) ) +
geom_line()
#Create tsibble
tsi <- data %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = c(new_infected, administrative_area_level_2), index = date_idx) %>%
select(c(date_idx, new_infected, administrative_area_level_2)) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" )
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
tsi %>%
ggplot(aes(x = date_idx, y = confirmed, color = administrative_area_level_2) ) +
geom_line()
tsi %>%
ggplot(aes(x = date_idx, y = new_infected, color = administrative_area_level_2) ) +
geom_line()
sorted = sort(sample(nrow(tsi), nrow(tsi)*.75))
train <- tsi[sorted,]
test <- tsi[-sorted,]
hh_fit <- train %>%
model(
Mean = MEAN(new_infected),
Naive = NAIVE(new_infected),
sNAIVE = SNAIVE(new_infected),
Drift = RW(new_infected ~ drift())
)
View(tsi)
View(train)
str(train)
pacman::p_load(tidyverse, fpp3, tsibble, feasts, fable)
#load USA sample data covid (statewise)
getwd()
data <- read.csv(file = "code/sample.csv", header = T)
#Create tsibble
tsi <- data %>%
#mutate(date = as_date(date)) %>%
as_tsibble(key = c(new_infected, administrative_area_level_2), index = date_idx) %>%
select(c(date_idx, new_infected, administrative_area_level_2)) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" )
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
str(tsi)
View(data)
#Create tsibble
tsi <- data %>%
#mutate(date = as_date(date)) %>%
as_tsibble(key = c(new_infected, administrative_area_level_2), index = date_idx) %>%
select(c(date_idx, new_infected, administrative_area_level_2)) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" ) %>%
select(-c("index"))
str(tsi)
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
#Create tsibble
tsi <- data %>%
#mutate(date = as_date(date)) %>%
as_tsibble(key = c(new_infected, administrative_area_level_2), index = date_idx) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" ) %>%
select(c(date_idx, new_infected, administrative_area_level_2))
str(tsi)
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
#Create tsibble
tsi <- data %>%
select(-c(index)) %>%
#mutate(date = as_date(date)) %>%
as_tsibble(key = c(new_infected, administrative_area_level_2), index = date_idx) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" ) %>%
select(c(date_idx, new_infected, administrative_area_level_2))
str(tsi)
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
View(tsi)
#Create tsibble
tsi <- data %>%
select(-c(index)) %>%
#mutate(date = as_date(date)) %>%
as_tsibble(index = date_idx) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" ) %>%
select(c(date_idx, new_infected, administrative_area_level_2))
#key = c(new_infected, administrative_area_level_2)
str(tsi)
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
View(tsi)
tsi %>%
ggplot(aes(x = date_idx, y = new_infected, color = administrative_area_level_2) ) +
geom_line()
sorted = sort(sample(nrow(tsi), nrow(tsi)*.75))
train <- tsi[sorted,]
test <- tsi[-sorted,]
hh_fit <- train %>%
model(
Mean = MEAN(new_infected),
Naive = NAIVE(new_infected),
sNAIVE = SNAIVE(new_infected),
Drift = RW(new_infected ~ drift())
)
#Create tsibble
tsi <- data %>%
select(-c(index)) %>%
#mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" ) %>%
select(c(new_infected, administrative_area_level_2))
#Create tsibble
tsi <- data %>%
select(-c(index)) %>%
#mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" ) %>%
select(c(date, new_infected, administrative_area_level_2))
str(data)
#Create tsibble
tsi <- data %>%
select(-c(index)) %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" ) %>%
select(c(date, new_infected, administrative_area_level_2))
#key = c(new_infected, administrative_area_level_2)
str(data)
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
#key = c(new_infected, administrative_area_level_2)
str(tsi)
tsi %>%
ggplot(aes(x = date_idx, y = new_infected, color = administrative_area_level_2) ) +
geom_line()
tsi %>%
ggplot(aes(x = date, y = new_infected, color = administrative_area_level_2) ) +
geom_line()
sorted = sort(sample(nrow(tsi), nrow(tsi)*.75))
train <- tsi[sorted,]
test <- tsi[-sorted,]
hh_fit <- train %>%
model(
Mean = MEAN(new_infected),
Naive = NAIVE(new_infected),
sNAIVE = SNAIVE(new_infected),
Drift = RW(new_infected ~ drift())
)
#Create tsibble
tsi <- data %>%
select(-c(index)) %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" ) %>%
select(c(date, new_infected, administrative_area_level_2)) %>%
tsibble::fill_gaps()
#key = c(new_infected, administrative_area_level_2)
str(tsi)
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
tsi %>%
ggplot(aes(x = date, y = new_infected, color = administrative_area_level_2) ) +
geom_line()
sorted = sort(sample(nrow(tsi), nrow(tsi)*.75))
train <- tsi[sorted,]
test <- tsi[-sorted,]
hh_fit <- train %>%
model(
Mean = MEAN(new_infected),
Naive = NAIVE(new_infected),
sNAIVE = SNAIVE(new_infected),
Drift = RW(new_infected ~ drift())
)
hh_fit <- train %>%
tsibble::fill_gaps() %>%
model(
Mean = MEAN(new_infected),
Naive = NAIVE(new_infected),
sNAIVE = SNAIVE(new_infected),
Drift = RW(new_infected ~ drift())
)
# predict
hh_pred <- hh_fit %>% forecast(h = 108)
hh_pred
pacman::p_load(GGally, ggthemes, ggfortify)
## put it together (do this properly without autoplot).
hh_pred %>%
autoplot(tsi, level = NULL) +
geom_vline(xintercept = max(train$date), lty = 2)
## put it together (do this properly without autoplot).
hh_pred %>%
autoplot(test, level = NULL) +
geom_vline(xintercept = max(train$date), lty = 2) +
## put it together (do this properly without autoplot).
hh_pred %>%
autoplot(test, level = NULL) +
geom_vline(xintercept = max(train$date), lty = 2)
## put it together (do this properly without autoplot).
hh_pred %>%
autoplot(tsi, level = NULL) +
geom_vline(xintercept = max(train$date), lty = 2)
View(train)
View(test)
sorted = floor(nrow(tsi)*.75)
train <- tsi[sorted,]
test <- tsi[-sorted,]
sorted = floor(nrow(tsi)*.75)
train <- slice_head(sorted)
train <- tsi %>%
slice_head(sorted)
train <- tsi %>%
slice_head(n = sorted)
sorted = floor(nrow(tsi)*.75)
train <- tsi %>%
slice_head(n = sorted)
test <- tsi %>%
slice_tail(n = length(tsi)-sorted)
sorted = floor(nrow(tsi)*.75)
train <- tsi %>%
slice_head(n = sorted)
test <- tsi %>%
slice_tail(n = sorted-length(tsi))
View(test)
sorted-length(tsi)
length(tsi)
length(tsi$date)
sorted-length(tsi$date)
sorted = floor(nrow(tsi)*.75)
train <- tsi %>%
slice_head(n = sorted)
test <- tsi %>%
slice_tail(n = length(tsi$date)-sorted)
View(test)
pacman::p_load(tidyverse, fpp3, tsibble, feasts, fable)
#load USA sample data covid (statewise)
getwd()
data <- read.csv(file = "code/sample.csv", header = T)
#Create tsibble
tsi <- data %>%
select(-c(index)) %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado" ) %>%
select(c(date, new_infected, administrative_area_level_2))
#key = c(new_infected, administrative_area_level_2)
str(tsi)
#|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada"
tsi %>%
ggplot(aes(x = date, y = new_infected, color = administrative_area_level_2) ) +
geom_line()
sorted = floor(nrow(tsi)*.75)
train <- tsi %>%
slice_head(n = sorted)
test <- tsi %>%
slice_tail(n = length(tsi$date)-sorted)
hh_fit <- train %>%
tsibble::fill_gaps() %>%
model(
Mean = MEAN(new_infected),
Naive = NAIVE(new_infected),
sNAIVE = SNAIVE(new_infected),
Drift = RW(new_infected ~ drift())
)
# predict
hh_pred <- hh_fit %>% forecast(h = 108)
hh_pred
pacman::p_load(GGally, ggthemes, ggfortify)
## put it together (do this properly without autoplot).
hh_pred %>%
autoplot(tsi, level = NULL) +
geom_vline(xintercept = max(train$date), lty = 2)
pacman::p_load(tidyverse, fpp3, tsibble, feasts, fable)
#load USA sample data covid (statewise)
getwd()
data <- read.csv(file = "code/sample.csv", header = T)
#Create tsibble
tsi <- data %>%
select(-c(index)) %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado"|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada" ) %>%
select(c(date, new_infected, administrative_area_level_2))
tsi %>%
ggplot(aes(x = date, y = new_infected, color = administrative_area_level_2) ) +
geom_line()
pacman::p_load(tidyverse, fpp3, tsibble, feasts, fable)
#load USA sample data covid (statewise)
getwd()
data <- read.csv(file = "code/sample.csv", header = T)
#Create tsibble
tsi <- data %>%
select(-c(index)) %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado"|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada" ) %>%
select(c(date, new_infected, administrative_area_level_2))
View(tsi)
#Create tsibble
tsi <- data %>%
select(-c(index)) %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado"|administrative_area_level_2 == "Mississippi" | administrative_area_level_2 == "Nevada" ) %>%
select(c(date, new_infected, administrative_area_level_2))
pacman::p_load(tidyverse, fpp3, tsibble, feasts, fable)
#load USA sample data covid (statewise)
getwd()
train <- read.csv(file = "data/usa_corona.csv", header = T)
#load USA sample data covid (statewise)
getwd()
data <- read.csv(file = "data/usa_corona.csv", header = T)
pacman::p_load(tidyverse, fpp3, tsibble, feasts, fable)
#load USA sample data covid (statewise)
getwd()
data <- read.csv(file = "data/usa_corona.csv", header = T)
#Create tsibble
tsi <- data %>%
select(-c(index)) %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado"|administrative_area_level_2 == "Mississippi" | administrative_area_level_2 == "Nevada" ) %>%
select(c(date, new_infected, administrative_area_level_2))
View(data)
#Create tsibble
tsi <- data %>%
select(-c(index, X)) %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado"|administrative_area_level_2 == "Mississippi" | administrative_area_level_2 == "Nevada" ) %>%
select(c(date, new_infected, administrative_area_level_2))
data %>% duplicates()
data %>% duplicates(date)
View(data)
#load USA sample data covid (statewise)
getwd()
data <- read.csv(file = "data/usa_corona.csv", header = T)
#Create tsibble
tsi <- data %>%
select(-c(index, X)) %>%
mutate(date = as_date(date)) %>%
as_tsibble(index = date) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado"|administrative_area_level_2 == "Mississippi" | administrative_area_level_2 == "Nevada" ) %>%
select(c(date, new_infected, administrative_area_level_2))
#Create tsibble
tsi <- data %>%
select(-c(index, X)) %>%
mutate(date = as_date(date)) %>%
#as_tsibble(index = date) %>%
#Subset states
# filter(administrative_area_level_2 == "Colorado"|administrative_area_level_2 == "Mississippi" | administrative_area_level_2 == "Nevada" ) %>%
#select(c(date, new_infected, administrative_area_level_2))
#Create tsibble
tsi <- data %>%
select(-c(index, X)) %>%
mutate(date = as_date(date)) #%>%
#as_tsibble(index = date) %>%
#Subset states
# filter(administrative_area_level_2 == "Colorado"|administrative_area_level_2 == "Mississippi" | administrative_area_level_2 == "Nevada" ) %>%
#select(c(date, new_infected, administrative_area_level_2))
#Create tsibble
tsi <- data %>%
select(-c(index, X)) %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = administrative_area_level_2, index = date) %>%
#Subset states
filter(administrative_area_level_2 == "Colorado"|administrative_area_level_2 == "Mississippi" |  administrative_area_level_2 == "Nevada" ) %>%
select(c(date, new_infected, administrative_area_level_2))
View(tsi)
#Create tsibble
tsi <- data %>%
select(-c(index, X)) %>%
mutate(date = as_date(date)) %>%
as_tsibble(key = administrative_area_level_2, index = date) %>%
#Subset states
filter(administrative_area_level_2 %in% c("New York", "Mississippi", "New Jersey", "Nevada", "Colorado" )) %>%
select(c(date, new_infected, administrative_area_level_2))
